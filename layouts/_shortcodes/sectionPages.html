{{- $cols := .Get "cols" | default 3 -}}
{{- $style := .Get "style" | default "" -}}
{{- $number := .Get "number" | default 6 -}}
{{- $currentDir := .Page.Path -}}

{{- $css := printf "--hextra-feature-grid-cols: %v; %s" $cols $style -}}

<div
  class="hextra-feature-grid hx:grid hx:sm:max-lg:grid-cols-2 hx:max-sm:grid-cols-1 hx:gap-4 hx:w-full not-prose"
  {{ with $css }}style="{{ . | safeCSS }}"{{ end }}
>

  {{ range first $number (site.GetPage $currentDir).Pages }}

    {{- $feature := (resources.Get .Params.feature) | default (resources.Get "images/default.png") -}}
    <a
      href="{{ .Permalink }}"
      style="background: radial-gradient(ellipse at 50% 80%,rgba(194,97,254,0.15),hsla(0,0%,100%,0));"
      class="hx:aspect-auto hx:md:aspect-[1.1/1] hx:max-md:min-h-[340px] hx:aspect-auto hx:md:aspect-[1.1/1] hx:max-md:min-h-[340px] hextra-feature-card not-prose hx:block hx:relative hx:overflow-hidden hx:rounded-3xl hx:border hx:border-gray-200 hx:hover:border-gray-300 hx:dark:border-neutral-800 hx:dark:hover:border-neutral-700 hx:before:pointer-events-none hx:before:absolute hx:before:inset-0 hx:before:bg-glass-gradient"
      >
      <div class="hx:relative hx:w-full hx:p-6">
        <h3 class="hx:text-2xl hx:font-medium hx:leading-6 hx:mb-2 hx:flex hx:items-center">
          <span>{{ .Title }}</span>
        </h3>
        {{- with .Params.subtitle -}}
          <p class="hx:text-gray-500 hx:dark:text-gray-400 hx:text-sm hx:leading-6 font-bold">
            {{- . | markdownify -}}
          </p>
        {{- end -}}
      </div>
  
      {{- $feature = $feature.Resize "500x webp q80" -}}

      <img src="{{ $feature.Permalink }}" class="hx:top-[40%] rounded-md hx:left-[24px] hx:w-[180%] hx:sm:w-[110%] hx:dark:opacity-80" alt="{{ .Title }}" />

    </a>
  
  {{- end -}}

</div>